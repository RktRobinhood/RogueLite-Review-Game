:root { --bg:#15151a; --panel:#202028; --gold:#f1c40f; --text:#ecf0f1; --green:#27ae60; --red:#c0392b; --blue:#2980b9; --accent:#9b59b6; }
@font-face { font-family: 'Retro'; src: local('Courier New'), monospace; }

body { margin:0; overflow:hidden; background:var(--bg); font-family:'Segoe UI',Tahoma,sans-serif; color:var(--text); touch-action:none; user-select:none; }

/* UTILS */
.screen { position:absolute; top:0; left:0; width:100%; height:100%; display:flex; flex-direction:column; overflow:hidden; }
.hidden { display:none !important; }
.center { display:flex; align-items:center; justify-content:center; }

/* LOADER */
#loader { background:#000; z-index:9999; }
.loader-bar-box { width:60%; height:10px; border:1px solid var(--green); margin-top:20px; }
.loader-bar { width:0%; height:100%; background:var(--green); transition:width 0.3s; }

/* SETUP */
.setup-container { flex-grow: 1; overflow-y: auto; width: 90%; margin: 20px 0; }
.setup-grid { display:grid; grid-template-columns:1fr; gap:10px; }
.lib-card { background:var(--panel); padding:15px; border:2px solid #555; border-radius:8px; cursor:pointer; text-align:left; display:flex; justify-content:space-between; align-items:center; transition: 0.2s; }
.checkmark { display:none; color:var(--green); font-weight:bold; font-size: 1.2rem; }
.lib-card.selected { border-color:var(--green); background:#1a2a1a; }
.lib-card.selected .checkmark { display:block; }

/* MENU */
.menu-container { width:100%; height:100%; display:flex; flex-direction:column; position:relative; }
.menu-header { padding: 15px; background: rgba(0,0,0,0.4); z-index: 20; display:flex; justify-content:space-between; align-items:center; }
.menu-content { flex-grow: 1; position: relative; overflow: hidden; display: flex; flex-direction: column; }

/* AVATAR (Background Layer) */
.avatar-bg {
    /* background decorative avatar removed - we use a single fixed avatar */
    display: none !important;
}
.base-part { position: absolute; background: #555; border-radius: 4px; left: 50%; transform: translateX(-50%); }
.base-head { top: 10px; width: 40px; height: 40px; display: flex; justify-content: center; align-items: center; font-size: 30px; z-index: 5; }
.base-torso { top: 55px; width: 36px; height: 50px; z-index: 4; border-radius: 6px; }
.base-legs  { top: 100px; width: 30px; height: 40px; z-index: 3; background: #444; }
.layer { position: absolute; left: 50%; transform: translateX(-50%); display:flex; justify-content:center; align-items:center; pointer-events: none;}
.l-head { top: -15px; z-index: 20; font-size: 40px; width: 80px; text-align: center; } 
.l-body { top: 55px; z-index: 15; font-size: 38px; } 
.l-feet { top: 100px; z-index: 16; font-size: 30px; } 
.l-main { top: 60px; left: 80px; z-index: 25; font-size: 28px; transform: rotate(-15deg); } 
.l-off  { top: 60px; left: 20px; z-index: 24; font-size: 28px; }

/* Game avatar box (larger when playing) */
/* Single fixed avatar shown in the corner so UI can flow around it */
.avatar-box { margin:0; position: fixed; right: 16px; top: 50%; transform: translateY(-50%); z-index: 999; width: 120px; pointer-events: none; }
.avatar-box .base-part { background: transparent; }
.avatar-box .base-head { font-size: 34px; }

/* Move main content left so it doesn't overlap the right-side avatar */
.menu-content, #gameScreen { padding-right: 160px; }

/* SHOP UI (Foreground Layer) */
.shop-ui-layer { 
    z-index: 10; position: relative; flex-grow: 1; display: flex; flex-direction: column; 
    background: rgba(21, 21, 26, 0.6); /* Semi-transparent dark to see avatar faintly but read text */
    backdrop-filter: blur(2px);
}
.shop-nav { display:flex; width:100%; background:rgba(0,0,0,0.6); border-bottom:1px solid #333; }
.nav-btn { flex:1; background:transparent; border:none; color:#aaa; padding:15px 0; font-weight:bold; cursor:pointer; border-bottom:3px solid transparent; }
.nav-btn.active { color:white; border-bottom-color:var(--accent); background:rgba(255,255,255,0.05); }

.shop-container { flex-grow:1; overflow-y:auto; padding:10px; padding-bottom: 100px; }
.shop-grid { display:grid; grid-template-columns:1fr 1fr; gap:8px; }
.shop-grid.active { display:grid; }

.shop-item { background:var(--panel); padding:10px; border-radius:8px; border:1px solid #444; display:flex; flex-direction:column; align-items:center; text-align:center; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }
.shop-item h3 { margin: 5px 0; font-size: 0.9rem; color: #ddd; }
.shop-item p { margin: 0 0 5px 0; font-size: 0.75rem; color: #888; }

.buy-btn { background:var(--green); color:white; border:none; padding:8px; width:100%; border-radius:4px; cursor:pointer; font-weight: bold; margin-top: auto; }
.buy-btn:disabled { background:#333; color:#555; }

/* PLAY BUTTON */
.play-bar { position: absolute; bottom: 0; left: 0; width: 100%; padding: 20px; box-sizing: border-box; background: linear-gradient(to top, #000, transparent); z-index: 30; pointer-events: none; }
.start-btn { pointer-events: auto; width: 100%; padding: 18px; font-size: 1.5rem; background: var(--gold); border: none; border-radius: 50px; font-weight: bold; color: #000; box-shadow: 0 5px 20px rgba(241,196,15,0.4); cursor: pointer; transition: transform 0.1s; }
.start-btn:active { transform: scale(0.98); }

/* GAME SCREEN */
#gameHUD { height:90px; display:flex; justify-content:space-between; align-items:flex-start; padding:10px 20px; background:rgba(0,0,0,0.4); position: relative; z-index: 10; }
#qArea { flex-grow:1; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:20px; font-size:1.3rem; text-align:center; overflow-y:auto; z-index: 10; }
#qText { width: 100%; max-width: 800px; }

/* INPUTS */
#inputContainer { height:35%; background:var(--panel); display:flex; flex-direction:column; padding:10px; box-sizing: border-box; z-index: 10; }
.choice-grid { display:grid; grid-template-columns:1fr 1fr; gap:10px; height:100%; }
.ans-btn { background:#34495e; color:white; border:none; border-radius:8px; font-size:1.1rem; cursor:pointer; transition:0.2s; }

/* ICONS */
.gear-icon { position:absolute; top:15px; right:70px; font-size:24px; cursor:pointer; z-index:100; width:40px; height:40px; background: #333; border-radius: 50%; display: flex; justify-content: center; align-items: center; border: 2px solid #555;}
/* In-game gear icon should be closer to the right edge */
#gameScreen .gear-icon { right: 15px; }
.powerup-bar { display: flex; gap: 15px; margin-top: 5px; }
.p-btn { width: 45px; height: 45px; border-radius: 50%; border: 2px solid #555; background: #333; color: white; font-size: 20px; cursor: pointer; position: relative; display: flex; justify-content: center; align-items: center; }
.p-count { position: absolute; top: -5px; right: -5px; background: var(--red); font-size: 10px; width: 18px; height: 18px; border-radius: 50%; display: flex; justify-content: center; align-items: center; border: 1px solid white; }
.p-btn.disabled { opacity: 0.3; pointer-events: none; filter: grayscale(1); }
.upgrade-dots { display:flex; gap:3px; margin:5px 0; }
.dot { width:6px; height:6px; background:#333; border-radius:50%; }
.dot.active { background:var(--gold); }
#preambleBox { background:rgba(255,255,255,0.05); border-left:4px solid var(--accent); padding:15px; margin-bottom:15px; border-radius:4px; width:90%; max-width:600px; font-size:1rem; line-height:1.4; display:none; text-align:left; }