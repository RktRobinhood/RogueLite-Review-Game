:root { --bg:#15151a; --panel:#202028; --gold:#f1c40f; --text:#ecf0f1; --green:#27ae60; --red:#c0392b; --blue:#2980b9; --accent:#9b59b6; }
@font-face { font-family: 'Retro'; src: local('Courier New'), monospace; }

body { margin:0; overflow:hidden; background:var(--bg); font-family:'Segoe UI',Tahoma,sans-serif; color:var(--text); touch-action:none; user-select:none; }

/* UTILS */
.screen { position:absolute; top:0; left:0; width:100%; height:100%; display:flex; flex-direction:column; overflow:hidden; }
.hidden { display:none !important; }
.center { display:flex; align-items:center; justify-content:center; }

/* LOADING */
#loader { background:#000; z-index:9999; }
.loader-bar-box { width:60%; height:10px; border:1px solid var(--green); margin-top:20px; }
.loader-bar { width:0%; height:100%; background:var(--green); transition:width 0.3s; }

/* SETUP SCREEN (New Hierarchy) */
.setup-container { width:90%; max-width:500px; max-height:70%; overflow-y:auto; text-align:left; }
.setup-group { margin-bottom: 20px; background: var(--panel); padding: 15px; border-radius: 8px; border: 1px solid #444; }
.setup-subject { color: var(--gold); font-weight: bold; border-bottom: 1px solid #555; margin-bottom: 10px; padding-bottom: 5px; font-size: 1.1rem; }
.topic-grid { display: flex; flex-wrap: wrap; gap: 8px; }
.topic-chip { 
    background: #333; padding: 8px 12px; border-radius: 20px; font-size: 0.9rem; cursor: pointer; border: 1px solid transparent; transition: 0.2s;
}
.topic-chip.selected { background: var(--blue); border-color: white; color: white; }
.topic-chip:hover { background: #444; }

/* MENU */
.menu-container { width:95%; max-width:600px; margin:0 auto; text-align:center; display:flex; flex-direction:column; gap:10px; height:100%; padding-top:10px; }
.shop-nav { display:flex; gap:5px; margin-bottom:5px; }
.nav-btn { flex:1; background:#333; border:none; color:#888; padding:10px 5px; cursor:pointer; border-radius:5px; font-weight:bold; font-size:0.9rem; }
.nav-btn.active { background:var(--accent); color:white; }

.shop-grid { display:grid; grid-template-columns:1fr 1fr; gap:8px; flex-grow:1; overflow-y:auto; padding-bottom:20px; display:none; }
.shop-grid.active { display:grid; }
.shop-item { background:var(--panel); padding:10px; border-radius:8px; border:1px solid #444; display:flex; flex-direction:column; align-items:center; text-align:center; }
.buy-btn { background:var(--green); color:white; border:none; padding:5px 12px; border-radius:4px; cursor:pointer; font-size:0.8rem; width:100%; margin-top:5px; }
.buy-btn:disabled { background:#333; color:#555; }
.shop-item.consumable { border-color:var(--blue); }
.shop-item.consumable .buy-btn { background:var(--blue); }

.big-btn { padding:15px 40px; font-size:1.4rem; background:var(--gold); color:#222; border:none; border-radius:50px; font-weight:bold; margin:15px 0; box-shadow:0 0 15px rgba(241,196,15,0.3); cursor:pointer; z-index: 50; }
.gear-icon { position:absolute; top:10px; right:10px; font-size:24px; cursor:pointer; z-index:100; }

/* GAME UI */
#gameHUD { height:80px; display:flex; justify-content:space-between; align-items:center; padding:0 20px; background:rgba(0,0,0,0.4); }
#qArea { flex-grow:1; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:20px; font-size:1.3rem; text-align:center; overflow-y:auto; }
#preambleBox { background:rgba(255,255,255,0.05); border-left:4px solid var(--accent); padding:15px; margin-bottom:15px; border-radius:4px; width:90%; max-width:600px; font-size:1rem; line-height:1.4; display:none; text-align:left; }
#preambleBox img { max-width:100%; border-radius:5px; margin-top:10px; }
#qText { width: 100%; max-width: 800px; }

/* INPUTS */
#inputContainer { height:40%; background:var(--panel); display:flex; flex-direction:column; }
.choice-grid { display:grid; grid-template-columns:1fr 1fr; gap:10px; padding:10px; height:100%; }
.ans-btn { background:#34495e; color:white; border:none; border-radius:8px; font-size:1.1rem; cursor:pointer; transition:0.2s; }
.ans-btn:active { transform:scale(0.98); }
.ans-btn.vanish { opacity: 0; pointer-events: none; }

/* AVATAR */
.avatar-box { width: 80px; height: 120px; position: relative; margin: 0 auto 5px auto; }
.base-part { position: absolute; background: #555; border-radius: 4px; left: 50%; transform: translateX(-50%); }
.base-head { top: 5px; width: 35px; height: 35px; display: flex; justify-content: center; align-items: center; font-size: 28px; z-index: 5; }
.base-torso { top: 45px; width: 30px; height: 40px; z-index: 4; border-radius: 6px; }
.base-legs  { top: 85px; width: 26px; height: 35px; z-index: 3; background: #444; }
.layer { position: absolute; left: 50%; transform: translateX(-50%); display:flex; justify-content:center; align-items:center; pointer-events: none;}
.l-head { top: -18px; z-index: 20; font-size: 32px; width: 60px; text-align: center; } 
.l-body { top: 45px; z-index: 15; font-size: 32px; } 
.l-feet { top: 85px; z-index: 16; font-size: 26px; } 
.l-main { top: 50px; left: 90%; z-index: 25; font-size: 24px; transform: rotate(-10deg); } 
.l-off  { top: 50px; left: 10%; z-index: 24; font-size: 24px; }

/* POWERUPS */
.powerup-bar { display: flex; gap: 15px; margin-top: 15px; }
.p-btn { width: 50px; height: 50px; border-radius: 50%; border: 2px solid #555; background: #333; color: white; font-size: 24px; cursor: pointer; position: relative; display: flex; justify-content: center; align-items: center; }
.p-count { position: absolute; top: -5px; right: -5px; background: var(--red); font-size: 10px; width: 18px; height: 18px; border-radius: 50%; display: flex; justify-content: center; align-items: center; border: 1px solid white; }
.p-btn.disabled { opacity: 0.3; pointer-events: none; filter: grayscale(1); }