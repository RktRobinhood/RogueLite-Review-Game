:root { --bg:#15151a; --panel:#202028; --gold:#f1c40f; --text:#ecf0f1; --green:#27ae60; --red:#c0392b; --blue:#2980b9; --accent:#9b59b6; }
@font-face { font-family: 'Retro'; src: local('Courier New'), monospace; }

body { margin:0; overflow:hidden; background:var(--bg); font-family:'Segoe UI',Tahoma,sans-serif; color:var(--text); touch-action:none; user-select:none; }

/* UTILS */
.screen { position:absolute; top:0; left:0; width:100%; height:100%; display:flex; flex-direction:column; overflow:hidden; }
.hidden { display:none !important; }
.center { display:flex; align-items:center; justify-content:center; }

/* LOADING */
#loader { background:#000; z-index:9999; }
.loader-bar-box { width:60%; height:10px; border:1px solid var(--green); margin-top:20px; }
.loader-bar { width:0%; height:100%; background:var(--green); transition:width 0.3s; }

/* SETUP */
.setup-grid { display:grid; grid-template-columns:1fr; gap:10px; width:90%; max-width:400px; margin:20px 0; max-height:60%; overflow-y:auto; }
.lib-card { background:var(--panel); padding:15px; border:2px solid #555; border-radius:8px; cursor:pointer; text-align:left; display:flex; justify-content:space-between; align-items:center; transition: 0.2s; }
/* IMPORTANT: Default checkmark is hidden unless selected */
.checkmark { display:none; color:var(--green); font-weight:bold; font-size: 1.2rem; }
.lib-card.selected { border-color:var(--green); background:#1a2a1a; }
.lib-card.selected .checkmark { display:block; }

/* MENU */
.menu-container { width:95%; max-width:600px; margin:0 auto; text-align:center; display:flex; flex-direction:column; gap:10px; height:100%; padding-top:10px; }
.shop-nav { display:flex; gap:5px; margin-bottom:5px; }
.nav-btn { flex:1; background:#333; border:none; color:#888; padding:10px 5px; cursor:pointer; border-radius:5px; font-weight:bold; font-size:0.9rem; }
.nav-btn.active { background:var(--accent); color:white; }
.shop-grid { display:grid; grid-template-columns:1fr 1fr; gap:8px; flex-grow:1; overflow-y:auto; padding-bottom:20px; display:none; }
.shop-grid.active { display:grid; }
.shop-item { background:var(--panel); padding:10px; border-radius:8px; border:1px solid #444; display:flex; flex-direction:column; align-items:center; text-align:center; }
.upgrade-dots { display:flex; gap:2px; margin:5px 0; }
.dot { width:6px; height:6px; background:#444; border-radius:50%; }
.dot.active { background:var(--gold); }

/* HUD */
#gameHUD { height:80px; display:flex; justify-content:space-between; align-items:center; padding:0 20px; background:rgba(0,0,0,0.4); position: relative; z-index: 10; }
#qArea { flex-grow:1; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:20px; font-size:1.3rem; text-align:center; overflow-y:auto; z-index: 10; }
#preambleBox { background:rgba(255,255,255,0.05); border-left:4px solid var(--accent); padding:15px; margin-bottom:15px; border-radius:4px; width:90%; max-width:600px; font-size:1rem; line-height:1.4; display:none; text-align:left; }
#chainStatus { font-size: 0.8rem; color: var(--accent); margin-bottom: 5px; font-weight: bold; display: none; }

/* DRAWING LAYER */
#drawLayer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 5; pointer-events: none; touch-action: none; }
#drawLayer.active { pointer-events: auto; cursor: crosshair; background: rgba(0,0,0,0.1); }

/* INPUTS */
#inputContainer { height:40%; background:var(--panel); display:flex; flex-direction:column; z-index: 10; }
.choice-grid { display:grid; grid-template-columns:1fr 1fr; gap:10px; padding:10px; height:100%; }
.match-grid { display:grid; grid-template-columns:1fr 1fr; gap:8px; padding:10px; height:100%; }
.match-item { background:#333; display:flex; align-items:center; justify-content:center; border-radius:5px; cursor:pointer; font-size:0.9rem; padding:5px; border:2px solid transparent; }
.match-item.selected { border-color:var(--gold); background:#444; }
.match-item.solved { opacity:0; pointer-events:none; }
.word-bank { display:flex; flex-wrap:wrap; gap:10px; padding:15px; justify-content:center; }
.word-chip { background:var(--blue); padding:10px 20px; border-radius:20px; cursor:pointer; }
.blank-slot { border-bottom:2px solid white; padding:0 10px; color:var(--gold); min-width:50px; display:inline-block; text-align:center; }

/* BUTTONS */
.buy-btn { background:var(--green); color:white; border:none; padding:5px 12px; border-radius:4px; cursor:pointer; font-size:0.8rem; width:100%; margin-top:5px; }
.buy-btn:disabled { background:#333; color:#555; }
.big-btn { padding:15px 40px; font-size:1.4rem; background:var(--gold); color:#222; border:none; border-radius:50px; font-weight:bold; margin:15px 0; box-shadow:0 0 15px rgba(241,196,15,0.3); }
.ans-btn { background:#34495e; color:white; border:none; border-radius:8px; font-size:1.1rem; cursor:pointer; transition:0.2s; }
.ans-btn:active { transform:scale(0.98); }
.gear-icon { position:absolute; top:10px; right:10px; font-size:24px; cursor:pointer; z-index:100; width:40px; height:40px; background: #333; border-radius: 50%; display: flex; justify-content: center; align-items: center; border: 2px solid #555;}

/* SETTINGS */
#settingsOverlay { position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:2000; flex-direction:column; align-items:center; justify-content:center; }
.setting-row { display:flex; justify-content:space-between; width:80%; max-width:400px; background:var(--panel); padding:15px; margin:5px; border-radius:8px; border:1px solid #444; align-items:center; }
.toggle-btn { width:50px; height:25px; background:#333; border-radius:15px; position:relative; cursor:pointer; transition:0.3s; }
.toggle-btn.active { background:var(--green); }
.toggle-knob { width:21px; height:21px; background:white; border-radius:50%; position:absolute; top:2px; left:2px; transition:0.3s; }
.toggle-btn.active .toggle-knob { left:27px; }